package plugin.gitlab.views;

import java.awt.Color;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;

import javax.swing.JMenu;

import org.eclipse.swt.widgets.*;
import org.eclipse.ui.part.ViewPart;
import org.json.JSONArray;
import org.json.JSONObject;

import plugin.gitlab.api.GitLabApi;



public class GitLabView extends ViewPart {
    private Button button;
    private GitLabApi gitLabAPI;
    public GitLabView() {
        super();
        gitLabAPI = new GitLabApi();
    }
    
	public void createPartControl(Composite parent) {
		
		button = new Button(parent, 0);
		String label_text = new String();
		JMenu editmenu = new JMenu("Edit");
	       menuItem = new JMenuItem("Undo Typing",KeyEvent.VK_U);
	        menuItem.getAccessibleContext().setAccessibleDescription("");
	        menuItem.addActionListener(this);
	        editmenu.add(menuItem);
		JSONArray jsonGroupsArray = new JSONArray(gitLabAPI.GitLabGetRequest("https://gitlab.com/api/v4/groups"));
		for(Object group_o : jsonGroupsArray )
		{
			JSONObject group = (JSONObject) group_o;
			Label GroupLabel = new Label(parent, 0);
			GroupLabel.setSize(200, 30);
			GroupLabel.setText(group.getInt("id") + " " + group.getString("name"));
			JSONArray jsonProjectsArray = new JSONArray(gitLabAPI.GitLabGetRequest("https://gitlab.com/api/v4/groups/" + group.getInt("id") + "/projects"));
			for(Object project_o : jsonProjectsArray )
			{
				JSONObject project = (JSONObject) project_o;
				button.setText(project.getString("name"));
				Label Projectlabel = new Label(parent, 0);
				GroupLabel.setSize(250, 30);
				Projectlabel.setText("- \t" + project.getString("name"));
			}
		}
	}

	@Override
	public void setFocus() {
		// TODO Auto-generated method stub
		
	}
}
